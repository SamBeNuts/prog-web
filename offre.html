<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Emna">
    <meta name="author" content="Ha">
    <meta name="author" content="Jin Yu">
    <meta name="author" content="Samuel">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSA - Prog Web</title>
    <link rel="icon" href="img/favicon-96x96.png" type="image/png" sizes="96x96">
    <link rel="stylesheet" type="text/css" href="css/base.css">
    <link rel="stylesheet" type="text/css" href="css/offre.css">
</head>
<body>
<div id="wrapper">
    <header>
        <img src="img/header_bg_offers.jpg" class="bg">
		<div class="filter">
            <select class="filter_search year" onchange="filter_year()">
				<option hidden>Année</option>
                <option value=""></option>
                <option value=""></option>
                <option value=""></option>
            </select>
			<select class="filter_search department" onchange="filter_department()">
				<option hidden>Département</option>
                <option value=""></option>
                <option value=""></option>
                <option value=""></option>
            </select>
			<select class="filter_search language" onchange="filter_language()">
				<option hidden>Langue du Cours</option>
                <option value=""></option>
                <option value=""></option>
                <option value=""></option>
            </select>
			<select class="filter_search country" onchange="filter_country()">
				<option hidden>Pays</option>
                <option value=""></option>
                <option value=""></option>
                <option value=""></option>
            </select>
        </div>
		<a href="index"><img src="img/logo_insa_w.png" class="logo_insa"></a>
        <nav role="navigation">
            <div class="menuToggle" onclick="menuToggle(this)">
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
            </div>
            <ul class="menuItems">
                <li><a href="index" class="text_white text_shadow">Accueil</a></li>
                <li><a href="offre" class="text_white text_shadow">Écoles partenaires</a></li>
                <li><a href="procedure" class="text_white text_shadow">Procédure</a></li>
                <li><a href="simu" class="text_white text_shadow">Simulation budget</a></li>
                <li><a href="FAQ" class="text_white text_shadow">FAQ</a></li>
                <!--<li>FR/EN</li>-->
            </ul>
        </nav>
    </header>
	<div class="content">
        <p class="title">Favoris</p>
        <div class="favoris">
        </div>
        <p class="title">Toutes les écoles</p>
        <input class="research" type="text" placeholder="Filtrer par nom" onkeyup="search()">
		<div class="schools">
		</div>
		<div class="number">
			<div class="line"></div>
			<p class="nb_result"></p>
		</div>
	</div>
    <footer>
        <p class="text_white">Thème, design et code réalisés par <span>E</span>mna, <span>H</span>a,
            <span>J</span>in <span>Y</span>u et <span>S</span>amuel - <a href="sitemap" class="text_white">plan
                du site</a></p>
    </footer>
</div>
<script type="text/javascript" src="js/request_data.js"></script>
<script type="text/javascript" src="js/cookies.js"></script>
<script type="text/javascript">
    function menuToggle(x) {
        x.parentElement.classList.toggle("active");
    }

	request.onload = function () {
        let data = request.response;
        add_schools(data.schools, getCookie('favoris'), '.favoris');
        add_schools(data.schools, Object.keys(data.schools), '.schools');
		document.querySelector(".nb_result").innerHTML = Object.keys(data.schools).length + ' résultats';
    };

	function add_schools(schools, schools_name, container) {
		let school_1 = "<a href='offre_utah/";
		let school_2 = "'><div class='school'><img class='image' src='img/data/";
		let school_3 = "'/><div class='over'><div class='info'><p class='text_white'><img src='img/student_icon.png'> ";
		let school_4 = "</p><p class='text_white'><img src='img/rank_icon.png'> the top ";
		let school_5 = "%</p><p class='text_white'><img src='img/language_icon.png'> ";
		let school_6 = " courses</p><p class='text_white'><img src='";
		let school_7 = "'/> estimated</p></div></div><p class='text_white name'>";
		let school_8 = "</p><div class='city'><div class='line'></div> <p class='text_white'>";
		let school_9 = "</p></div></div></a>";

		for(let i=0; i<schools_name.length; i++){
		    let school = schools_name[i];
            document.querySelector(container).innerHTML += school_1 + school_2 + school.toLowerCase().replace(/ /g, '_') +
                '_thumbnail.jpg' + school_3 + schools[school].courses[0][1] + school_4 + schools[school].top + school_5 +
                schools[school].courses[0][2] + school_6 + school_7 + school + school_8 +
                schools[school].city + ", " + schools[school].country + school_9;
        }
	}
	
	function search() {
        let research = document.querySelector('.research').value;
        let schools = document.querySelectorAll('.schools .school .name');
		for (let i=0; i < schools.length; i++){
			if (!schools[i].innerHTML.toLowerCase().includes(research.toLowerCase())){
				schools[i].parentElement.style.display = 'none';
			}else{
				schools[i].parentElement.style.display = 'inline-block';
			}
		}
    }
	
	function filter_year() {
        let research = document.querySelector('.filter .year').value;
        let schools = document.querySelectorAll('.school .over');
		for (let i=0; i < schools.length; i++){
			if (!schools[i].children[0].innerHTML.toLowerCase().includes(research.toLowerCase())){
				schools[i].parentElement.style.display = 'none';
			}else{
				schools[i].parentElement.style.display = 'inline-block';
			}
		}
    }
	
	function filter_department() {
        let research = document.querySelector('.filter .department').value;
        let schools = document.querySelectorAll('.school .over');
		for (let i=0; i < schools.length; i++){
			if (!schools[i].children[1].innerHTML.toLowerCase().includes(research.toLowerCase())){
				schools[i].parentElement.style.display = 'none';
			}else{
				schools[i].parentElement.style.display = 'inline-block';
			}
		}
    }
	
	function filter_language() {
        let research = document.querySelector('.filter .language').value;
        let schools = document.querySelectorAll('.school .over');
		for (let i=0; i < schools.length; i++){
			if (!schools[i].children[2].innerHTML.toLowerCase().includes(research.toLowerCase())){
				schools[i].parentElement.style.display = 'none';
			}else{
				schools[i].parentElement.style.display = 'inline-block';
			}
		}
    }
	
	function filter_country() {
        let research = document.querySelector('.filter .country').value;
        let schools = document.querySelectorAll('.school .over');
		for (let i=0; i < schools.length; i++){
			if (!schools[i].children[3].innerHTML.toLowerCase().includes(research.toLowerCase())){
				schools[i].parentElement.style.display = 'none';
			}else{
				schools[i].parentElement.style.display = 'inline-block';
			}
		}
    }
</script>
</body>
</html>